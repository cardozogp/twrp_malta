- pipeline: "Builf"
  on: "CLICK"
  refs:
  - "refs/heads/main"
  priority: "NORMAL"
  fail_on_prepare_env_warning: true
  actions:
  - action: "Execute: npm test"
    type: "BUILD"
    docker_image_name: "fr3akyphantom/droid-builder"
    docker_image_tag: "focal"
    execute_commands:
  - cd /home; mkdir -p twrp; cd twrp
  - git config --global user.email "maizondroidplay@gmail.com
  - git config --global user.name "maicon"
  - repo init --depth=1 -u git://github.com/minimal-manifest-twrp/platform_manifest_twrp_omni.git -b twrp-9.0
  - git clone https://github.com/maizon/twrp_malta_device_tree device/motorola/malta
  - repo sync -j9 --force-sync
  - source build/envsetup.sh
  - export ALLOW_MISSING_DEPENDENCIES=true; export FOX_USE_TWRP_RECOVERY_IMAGE_BUILDER=1 ;export LC_ALL="C" ;export ALLOW_MISSING_DEPENDENCIES=true; . build/envsetup.sh; lunch omni_malta-eng; mka bootimage
  - cd /home/twrp/out/target/product/malta/
  - curl -s --upload-file boot.img https://transfer.sh/ 
  - curl -s --upload-file recovery.img https://transfer.sh/ 
    
